# 如果没装 uv，就直接退出，避免报错
if ! has uv; then
  echo "uv 未找到，跳过虚拟环境激活" >&2
  return 1
fi

# 如果还没有 .venv，就用 uv 创建一个
if [ ! -d .venv ]; then
  uv venv
fi

# 告诉 shell 当前虚拟环境路径
export VIRTUAL_ENV="$PWD/.venv"

# Windows: .venv/Scripts
if [ -d "$VIRTUAL_ENV/Scripts" ]; then
  PATH_add "$VIRTUAL_ENV/Scripts"
# Linux/macOS: .venv/bin
elif [ -d "$VIRTUAL_ENV/bin" ]; then
  PATH_add "$VIRTUAL_ENV/bin"
fi
